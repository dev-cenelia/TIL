# Event Loop 정리



## 1. 콜스택(Call Stack)
- 자바스크립트가 **현재 실행해야 할 함수들을 쌓아두는 스택 구조**
- 함수가 호출되면 스택에 push  
- 함수가 끝나면 pop  
- **싱글 스레드 → 한 번에 하나씩만 실행**

예)
- 함수 A 호출 → 스택에 A push  
- A 안에서 B 호출 → 스택에 B push  
- B 끝 → pop  
- A 끝 → pop  



## 2. 태스크 큐(Task Queue)
비동기 작업들이 “나중에 실행되기 위해” 대기하는 공간.  
종류는 크게 2가지:

### ✔ 마이크로태스크 큐 (Microtask Queue)
- **Promise.then**
- **async/await 내부 처리**
- **queueMicrotask**
- 우선순위 가장 높음
- 이벤트 루프는 마이크로태스크 큐에 있는 작업을 **전부 먼저 처리함**

### ✔ 매크로태스크 큐 (Macrotask Queue)
- setTimeout  
- setInterval  
- DOM 이벤트 콜백

→ 마이크로태스크가 모두 끝난 뒤 **하나씩** 실행됨



## 3. 이벤트 루프(Event Loop)란?
- JS가 **비동기 작업을 처리하는 핵심 메커니즘**
- 역할:  
  1) 콜스택이 비었는지 확인  
  2) 비면 → **마이크로태스크 큐를 먼저 전부 실행**  
  3) 그 다음 → 매크로태스크 큐에서 **하나 실행**  
  4) 다시 반복



## 4. 실행 순서 규칙
1. 콜스택이 비면  
2. **마이크로태스크 전체 처리**  
3. 매크로태스크 하나 처리  
4. 다시 1번 반복

→ 그래서 setTimeout보다 Promise.then이 항상 빠름



## 5. 예제

```js
console.log("A");

Promise.resolve().then(() => console.log("B"));

setTimeout(() => console.log("C"), 0);

console.log("D");
```

출력 순서
```
A
D
B
C
```

설명:
- `A`, `D` = 동기 → 바로 콜스택에서 실행  
- `Promise.then` = 마이크로태스크 → 즉시 처리  
- `setTimeout` = 매크로태스크 → 그 다음 실행



## 6. 핵심 요약
- **콜스택 = 실행 중인 함수들이 쌓이는 곳 (싱글 스레드)**  
- **마이크로태스크 큐 = Promise 관련 작업 (우선순위 1등, 전체 먼저 처리)**  
- **매크로태스크 큐 = setTimeout 등 (마이크로 다음에 하나씩)**  
- **이벤트 루프 = 콜스택이 비면 큐에서 작업 가져와 실행시키는 조절자**

---
